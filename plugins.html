<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Plugin development | Formula.Bot</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Documentation for the opensource Formula Discord bot.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.0e6dcbac.js" as="script"><link rel="preload" href="/assets/js/2.abba3bcd.js" as="script"><link rel="preload" href="/assets/js/8.adcc7672.js" as="script"><link rel="prefetch" href="/assets/js/3.5be4aa20.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.76fc70b2.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.0063e81d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Formula.Bot</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/Formula-Bot/Formula.Bot.Docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/Formula-Bot/Formula.Bot.Docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Get started</a></li><li><a href="/plugins.html" aria-current="page" class="active sidebar-link">Plugin development</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/plugins.html#creating-a-new-plugin-using-the-plugin-template" class="sidebar-link">Creating a new plugin using the plugin template</a></li><li class="sidebar-sub-header"><a href="/plugins.html#creating-a-new-plugin" class="sidebar-link">Creating a new plugin</a></li><li class="sidebar-sub-header"><a href="/plugins.html#adding-a-plugin-to-the-container" class="sidebar-link">Adding a plugin to the container</a></li><li class="sidebar-sub-header"><a href="/plugins.html#configuration" class="sidebar-link">Configuration</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="plugin-development"><a href="#plugin-development" class="header-anchor">#</a> Plugin development</h1> <blockquote><p>Formula.Bot uses a plugin pattern to keep it's core functionally lightweight. If you wish to extend Formula.Bot, you can do so by installing, or developing your own plugins. This page will explain you how to create or install already existing plugins.</p></blockquote> <p></p><div class="table-of-contents"><ul><li><a href="#creating-a-new-plugin-using-the-plugin-template">Creating a new plugin using the plugin template</a></li><li><a href="#creating-a-new-plugin">Creating a new plugin</a></li><li><a href="#adding-a-plugin-to-the-container">Adding a plugin to the container</a></li><li><a href="#configuration">Configuration</a><ul><li><a href="#enabling-configuration-for-plugin">Enabling Configuration for Plugin</a></li><li><a href="#adding-plugin-configuration">Adding Plugin Configuration</a></li></ul></li></ul></div><p></p> <h2 id="creating-a-new-plugin-using-the-plugin-template"><a href="#creating-a-new-plugin-using-the-plugin-template" class="header-anchor">#</a> Creating a new plugin using the plugin template</h2> <p>To create a plugin using the plugin template, you will first have to install the plugin template. You can do this by using the <code>dotnet</code> cli command. This allows you to create a new project based on the provided template with one simple command.</p> <ol><li>Make sure the plugin template is installed correctly by executing the following command:</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet new -i Formula.Bot.Templates.Plugin
</code></pre></div><ol start="2"><li>Create a new project with the provided template:</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet new formulabot-plugin -n <span class="token string">&quot;Formula.Bot.Plugins.Example&quot;</span> -o Formula.Bot.Plugins.Example
</code></pre></div><p><code>-o</code> -&gt; Output directory to use<br> <code>-n</code> -&gt; Namespace to use<br>
3. Confirm the project got created with the correct namespace &amp; folder used.
Because you used the plugin template, you will not have to do all the tedious tasks related to the csproj described in &quot;Creating a new plugin&quot;. Do note that you can still execute step 6 from that instruction for automatic build artifacts copying.</p> <h2 id="creating-a-new-plugin"><a href="#creating-a-new-plugin" class="header-anchor">#</a> Creating a new plugin</h2> <p>To create a new plugin, make sure the used .NET SDK is installed. Currently, the bot runs on <a href="https://dotnet.microsoft.com/download/dotnet/5.0" target="_blank" rel="noopener noreferrer">.NET 5<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, but this may be changed in the future. Just make sure this matches the core project, as you might otherwise run into issues.</p> <blockquote><p><em>This instruction assumes you use the Visual Studio Code IDE.</em></p></blockquote> <ol><li>Create a new class library with the following naming convention: <code>Formula.Bot.Plugins.PluginNamePascalCased</code>. For example, a plugin with the name MyPlugin would become <code>Formula.Bot.Plugins.MyPlugin</code>.</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet new classlib -n <span class="token string">&quot;Formula.Bot.Plugins.{PLUGIN_NAME}&quot;</span> -o <span class="token string">&quot;Formula.Bot.Plugins.{PLUGIN_NAME}&quot;</span>
</code></pre></div><p>eg</p> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet new classlib -n <span class="token string">&quot;Formula.Bot.Plugins.MyPlugin&quot;</span> -o <span class="token string">&quot;Formula.Bot.Plugins.MyPlugin&quot;</span>
</code></pre></div><ol start="2"><li>Add the <code>csproj</code> to the main <code>sln</code> file:</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet sln <span class="token function">add</span> <span class="token string">&quot;Formula.Bot.Plugins.{PLUGIN_NAME}/Formula.Bot.Plugins.{PLUGIN_NAME}.csproj&quot;</span>
</code></pre></div><p>eg</p> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet sln <span class="token function">add</span> <span class="token string">&quot;Formula.Bot.Plugins.MyPlugin/Formula.Bot.Plugins.MyPlugin.csproj&quot;</span>
</code></pre></div><ol start="3"><li>Add a reference to the core project:</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet <span class="token function">add</span> <span class="token string">&quot;Formula.Bot.Plugins.{PLUGIN_NAME}/Formula.Bot.Plugins.{PLUGIN_NAME}.csproj&quot;</span> reference <span class="token string">&quot;Formula.Bot/Formula.Bot.csproj&quot;</span>
</code></pre></div><p>eg</p> <div class="language-sh extra-class"><pre class="language-sh"><code>dotnet <span class="token function">add</span> <span class="token string">&quot;Formula.Bot.Plugins.MyPlugin/Formula.Bot.Plugins.{PLUGIN_NAME}.csproj&quot;</span> reference <span class="token string">&quot;Formula.Bot/Formula.Bot.csproj&quot;</span>
</code></pre></div><ol start="4"><li>To make sure the referenced core project does not get outputted when building, find and change the <code>ProjectReference</code> to add <code>&lt;Private&gt;true&lt;/Private&gt;</code> &amp; <code>&lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;</code></li></ol> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ProjectReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>..\Formula.Bot\Formula.Bot.csproj<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Private</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Private</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ExcludeAssets</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ExcludeAssets</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ProjectReference</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="5"><li>Add <code>&lt;CopyLocalLockFileAssemblies&gt;true&lt;/CopyLocalLockFileAssemblies&gt;</code> to the first <code>PropertyGroup</code>.</li> <li>(optional) For easier plugin output copying to the core project, add the following part to your csproj:</li></ol> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Target</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>PostBuild<span class="token punctuation">&quot;</span></span> <span class="token attr-name">AfterTargets</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>PostBuildEvent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Exec</span> <span class="token attr-name">Command</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mkdir -p <span class="token entity named-entity" title="&quot;">&amp;quot;</span>$(SolutionDir)Formula.Bot/Plugins<span class="token entity named-entity" title="&quot;">&amp;quot;</span>;cp -RTf <span class="token entity named-entity" title="&quot;">&amp;quot;</span>$(TargetDir)<span class="token entity named-entity" title="&quot;">&amp;quot;</span> <span class="token entity named-entity" title="&quot;">&amp;quot;</span>$(SolutionDir)Formula.Bot/Plugins/$(TargetName)<span class="token entity named-entity" title="&quot;">&amp;quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Target</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="7"><li>Your finished <code>csproj</code> should look something like this:</li></ol> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Project</span> <span class="token attr-name">Sdk</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.NET.Sdk<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PropertyGroup</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TargetFramework</span><span class="token punctuation">&gt;</span></span>net5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TargetFramework</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileVersion</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AssemblyVersion</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AssemblyVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CopyLocalLockFileAssemblies</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CopyLocalLockFileAssemblies</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PropertyGroup</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ProjectReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>..\Formula.Bot\Formula.Bot.csproj<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Private</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Private</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ExcludeAssets</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ExcludeAssets</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ProjectReference</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- Optional --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Target</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>PostBuild<span class="token punctuation">&quot;</span></span> <span class="token attr-name">AfterTargets</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>PostBuildEvent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Exec</span> <span class="token attr-name">Command</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mkdir -p <span class="token entity named-entity" title="&quot;">&amp;quot;</span>$(SolutionDir)Formula.Bot/Plugins<span class="token entity named-entity" title="&quot;">&amp;quot;</span>;cp -RTf <span class="token entity named-entity" title="&quot;">&amp;quot;</span>$(TargetDir)<span class="token entity named-entity" title="&quot;">&amp;quot;</span> <span class="token entity named-entity" title="&quot;">&amp;quot;</span>$(SolutionDir)Formula.Bot/Plugins/$(TargetName)<span class="token entity named-entity" title="&quot;">&amp;quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Target</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Project</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="8"><li>Project &amp; solution wise, you are done. Now, you need to make sure your initial <code>Plugin</code> class implementation exists. Add a file called <code>Core.cs</code> that implements the <code>Plugin</code> class from the <code>Formula.Bot.Abstractions</code> namespace.</li></ol> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">Formula<span class="token punctuation">.</span>Bot<span class="token punctuation">.</span>Abstractions</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">Formula<span class="token punctuation">.</span>Bot<span class="token punctuation">.</span>Plugins<span class="token punctuation">.</span>MyPlugin</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Core</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Plugin</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">&quot;MyPlugin&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Description <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">&quot;This is my super cool plugin. Yup, I made this myself.&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="9"><li>This is the minimal you need for your plugin to be recognized. Though, this in and of itself is not quite useful. Let's add a <code>Activate</code> event handler. This is a virtual method in the <code>Plugin</code> class that you can override by typing</li></ol> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// ...</span>
        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><p>In here, you can add anything you want to be executed when the plugin gets loaded in and initialized.<br>
10. Though, at some point you may also want to reload a plugin. For that to work, you will also need to register a <code>Terminate</code> handler in the event that you leave any existing references to the core project that the GC cannot cleanup.</p> <blockquote><p><strong>Note!</strong> It is very important to make sure your referenced objects are cleaned up, otherwise you may leak the PluginContextLoader which leads to a wrong unloaded plugin that may result in unexpected behavior.</p></blockquote> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// ...</span>
        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">Terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">// ...</span>
</code></pre></div><h2 id="adding-a-plugin-to-the-container"><a href="#adding-a-plugin-to-the-container" class="header-anchor">#</a> Adding a plugin to the container</h2> <p>To add a new plugin to an existing deployed container, follow the following steps.
First, determine which plugin you would like to add. You will need the part after <code>Formula.Bot.Plugins.</code></p> <blockquote><p><code>{PLUGIN_NAME}</code> -&gt; The part that comes right after <code>Formula.Bot.Plugins.</code> in the repository name.<br> <code>{LOWERCASE_PLUGIN_NAME}</code> -&gt; Same as <code>PLUGIN_NAME</code>, but well.. in lowercase.</p></blockquote> <ol><li>Add the following part to the <code>docker-compose.plugins.yml</code> file. If this file does not exist, please follow step 4 of the deployment instruction.</li></ol> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">formulabot</span><span class="token punctuation">:</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> formulabot<span class="token punctuation">-</span>plugin<span class="token punctuation">-</span><span class="token punctuation">{</span>LOWERCASE_PLUGIN_NAME<span class="token punctuation">}</span><span class="token punctuation">:</span>/app/Plugins/Formula.Bot.Plugins.<span class="token punctuation">{</span>PLUGIN_NAME<span class="token punctuation">}</span>/
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  formulabot<span class="token punctuation">-</span>plugin<span class="token punctuation">-</span><span class="token punctuation">{</span>LOWERCASE_PLUGIN_NAME<span class="token punctuation">}</span><span class="token punctuation">:</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre></div><p>For example, if you wanted to add the <code>Formula.Bot.Plugins.Metrics</code> plugin you'd type:</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">formulabot</span><span class="token punctuation">:</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> formulabot<span class="token punctuation">-</span>plugin<span class="token punctuation">-</span>metrics<span class="token punctuation">:</span>/app/Plugins/Formula.Bot.Plugins.Metrics/
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">formulabot-plugin-metrics</span><span class="token punctuation">:</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre></div><ol start="2"><li>Run the following command to create the volumes on your host system. Because these are not managed by Docker Compose (due to the <code>external: true</code> part), you'll have to create them yourself.</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>docker volume create formulabot-plugins-<span class="token punctuation">{</span>LOWERCASE_PLUGIN_NAME<span class="token punctuation">}</span>
</code></pre></div><p>For example with the metrics plugin:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker volume create formulabot-plugins-metrics
</code></pre></div><ol start="3"><li>If your plugin requires configuration, make sure to write that now, by following the <code>Adding Plugin Configuration</code> instructions.</li> <li>Because you modified the <code>docker-compose.*.yml</code> file, you'll have to restart your compose containers to apply your changes. After you executed that command, your plugin should be correctly enabled and working.</li></ol> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <blockquote><p>For plugins, Formula.Bot allows you to load in <code>.json</code> files from a specified directory. You must enable this feature manually within your <code>Plugin</code> instance, explained below.</p></blockquote> <h3 id="enabling-configuration-for-plugin"><a href="#enabling-configuration-for-plugin" class="header-anchor">#</a> Enabling Configuration for Plugin</h3> <p>By default, plugins are configuration-less; meaning that your plugin has no extra data files attached that it can load. If that is the case however, you will have to define that in your <code>Plugin</code> Instance by adding the interface <code>IPluginSettings</code> to your implementation. This interface takes one generic argument which is the settings model to deserialize your json to.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token comment">// ...</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Core</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Plugin</span><span class="token punctuation">,</span> <span class="token class-name">IPluginSettings<span class="token punctuation">&lt;</span>PluginSettings<span class="token punctuation">&gt;</span></span></span> <span class="token comment">// &lt;- note the IPluginSettings</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">&quot;ExamplePlugin&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Description <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">&quot;My example plugin&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token return-type class-name">PluginSettings</span> Settings <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PluginSettings</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> MySetting <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
</code></pre></div><p>Just before calling <code>Activate</code>, your plugin will load in your settings file from the specified location in your <code>PluginConfigFolder</code>. The filename should follow the following format: <code>PluginName.settings.json</code>, eg <code>ExamplePlugin.settings.json</code>:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;MySetting&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hello world&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>By default, your deserialized settings type will be provided as the <code>Settings</code> property in your plugin implementation. If you wish, you can apply a singleton pattern to it like so:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PluginSettings</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">PluginSettings</span> Instance <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">private</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> MySetting <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token function">PluginSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>This allows you to fetch the value from anywhere in your plugin.</p> <h3 id="adding-plugin-configuration"><a href="#adding-plugin-configuration" class="header-anchor">#</a> Adding Plugin Configuration</h3> <p>For plugin configuration, you'll have to create a <code>.json</code> settings file per plugin. To do such a thing, first make sure your <code>settings.json</code> file is reading the correct plugin config folder location. This can be specified using the <code>$.PluginLoader.PluginConfigFolder</code> property in the settings file. By default this is <code>data/plugins</code>. If you mounted the working container in your docker-compose file to <code>data</code>, you can just create a new folder called <code>plugins</code> and place your configuration files in there. Make sure the plugin configuration files follow the following format: <code>PluginName.settings.json</code>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Formula-Bot/Formula.Bot.Docs/edit/master/plugins.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/" class="prev router-link-active">
        Get started
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0e6dcbac.js" defer></script><script src="/assets/js/2.abba3bcd.js" defer></script><script src="/assets/js/8.adcc7672.js" defer></script>
  </body>
</html>
